{"version":3,"sources":["core/commands.js"],"names":[],"mappings":"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","file":"core/commands.js","sourcesContent":["var Crypto = require(\"crypto\");\nvar Util = require(\"util\");\nvar vorpal = require(\"vorpal\")();\n\nimport Board from '../boards/board';\nvar config = require(\"../helpers/config\");\nvar Database = require(\"../helpers/database\");\nvar Tools = require(\"../helpers/tools\");\n\nimport * as Renderer from '../core/renderer';\nimport * as IPC from '../helpers/ipc';\nimport * as PostsModel from '../models/posts';\nimport * as UsersModel from '../models/users';\n\nvar requestPassword = function(thisArg) {\n    var c = {};\n    return thisArg.prompt.call(thisArg, {\n        type: \"password\",\n        name: \"password\",\n        message: Tools.translate(\"Enter password: \"),\n    }).then(function(result) {\n        c.password = result.password;\n        if (!c.password)\n            return Promise.reject(Tools.translate(\"Invalid password\"));\n        if (!Tools.mayBeHashpass(c.password))\n            return Promise.resolve();\n        return thisArg.prompt.call(thisArg, {\n            type: \"confirm\",\n            name: \"hashpass\",\n            default: true,\n            message: Tools.translate(\"That is a hashpass, isn't it? \")\n        });\n    }).then(function(result) {\n        var notHashpass = (!result || !result.hashpass);\n        return Promise.resolve({\n            password: c.password,\n            notHashpass: notHashpass\n        });\n    });\n};\n\nvorpal.installHandler = function(cmd, f, options) {\n    var description = (options && options.description) || undefined;\n    var command = vorpal.command(cmd, description).action(function(args, callback) {\n        var prompt = this.prompt;\n        var _this = this;\n        this.prompt = function(options) {\n            return new Promise(function(resolve, reject) {\n                var simple = (typeof options == \"string\");\n                if (simple) {\n                    options = {\n                        message: options,\n                        name: \"input\"\n                    };\n                }\n                prompt.call(_this, options, function(result) {\n                    resolve(simple ? result.input : result);\n                });\n            });\n        };\n        f.call(this, args).then(function(result) {\n            if (result)\n                console.log(result);\n            callback();\n        }).catch(function(err) {\n            console.log((err && err.stack) || err);\n            callback();\n        });\n    }).cancel(function () {\n        console.log(Tools.translate(\"Cancelled\"));\n    });\n    if (options && options.alias) {\n        if (Util.isArray(options.alias))\n            command.alias.apply(command, options.alias);\n        else\n            command.alias(options.alias);\n    }\n    if (options && Util.isArray(options.options)) {\n        options.options.forEach(function(opt) {\n            command.option(opt.value, opt.description || undefined);\n        });\n    }\n};\n\nvorpal.find(\"exit\").remove();\n\nvorpal.installHandler(\"quit\", function() {\n    process.exit(0);\n    return Promise.resolve(\"OK\");\n}, {\n    description: Tools.translate(Tools.translate(\"Quits the application.\")),\n    alias: [\"exit\", \"q\"]\n});\n\nvorpal.installHandler(\"respawn [exitCode]\", function(args) {\n    var exitCode = !isNaN(+args.exitCode) ? +args.exitCode : 0;\n    return IPC.send('exit', exitCode, true).then(function() {\n        return Promise.resolve(\"OK\");\n    });\n}, { description: Tools.translate(\"Respawns worker processes with the passed exit code.\") });\n\nvorpal.installHandler(\"set <key> [value]\", function(args) {\n    var path = args.key;\n    var value = args.value;\n    if (!path)\n        return Promise.reject(Tools.translate(\"Invalid command. Type 'help' for commands\"));\n    if (value) {\n        try {\n            console.log(value);\n            value = JSON.parse(value);\n        } catch (err) {\n            //Do nothing\n        }\n        config.set(path, value);\n        return Promise.resolve(\"OK\");\n    }\n    return this.prompt(Tools.translate(\"Enter value for\") + \" '\" + path + \"': \").then(function(result) {\n        config.set(path, (typeof result == \"string\") ? result : JSON.parse(answer));\n        return Promise.resolve(\"OK\");\n    });\n}, {\n    description: Tools.translate(\"Sets the option (config.json) at the key specified. \"\n        + \"If no value is specified, prompts to enter it.\")\n});\n\nvorpal.installHandler(\"get <key>\", function(args) {\n    var path = args.key;\n    if (!path)\n        return Promise.reject(console.log(Tools.translate(\"Invalid command. Type 'help' for commands\")));\n    var v = config(path);\n    if (undefined == v)\n        return Promise.reject(\"No such value\");\n    return Promise.resolve(Tools.translate(\"Value for\") + \" '\" + path + \"': \" + JSON.stringify(v, null, 4));\n}, { description: Tools.translate(\"Prints the option (config.json) at the key specified.\") });\n\nvorpal.installHandler(\"remove <key>\", function(args) {\n    var path = args.key;\n    if (!path)\n        Promise.reject(Tools.translate(\"Invalid command. Type 'help' for commands\"));\n    config.remove(path);\n    return Promise.resolve(\"OK\");\n}, { description: Tools.translate(\"Removes the option (config.json) at the key specified.\") });\n\nvorpal.installHandler('add-superuser', async function() {\n  let { password, notHashpass } = await requestPassword(this);\n  let { input } = await this.prompt(Tools.translate('Enter superuser IP list (separate by spaces): '));\n  let ips = Tools.ipList(input);\n  if (typeof ips === 'string') {\n    return Promise.reject(new Error(ips));\n  }\n  let hashpass = Tools.toHashpass(password, notHashpass);\n  await UsersModel.addSuperuser(hashpass, ips);\n  return 'OK';\n}, { description: Tools.translate('Registers a superuser.') });\n\nvorpal.installHandler('remove-superuser', async function() {\n  let { password, notHashpass } = await requestPassword(this);\n  let hashpass = Tools.toHashpass(password, notHashpass);\n  await UsersModel.removeSuperuser(hashpass);\n  return 'OK';\n}, { description: Tools.translate('Unregisters a superuser.') });\n\nvorpal.installHandler('rerender-posts [targets...]', async function(args) {\n  let result = await this.prompt({\n    type: 'confirm',\n    name: 'rerender',\n    default: true,\n    message: Tools.translate('Are you sure? ')\n  });\n  if (!result.rerender) {\n    return;\n  }\n  let targets = Tools.rerenderPostsTargetsFromString((args.targets || []).join(' '));\n  await PostsModel.rerenderPosts(targets);\n  //TODO: Rerender corresponding pages?\n  return 'OK';\n}, {\n  description: Tools.translate('Rerenders posts specified as $[1].\\n'\n    + 'If $[1] is omitted, rerenders all posts on all boards.\\n'\n    + 'Each target is a string in the following form:\\n'\n    + '$[2]', '', '[targets...]', '<board name>[:<post number>[:...]]')\n});\n\nvorpal.installHandler(\"stop\", function() {\n    return IPC.send('stop').then(function() {\n        return Promise.resolve(\"OK\");\n    });\n}, { description: Tools.translate(\"Closes all workers, preventing incoming connections.\") });\n\nvorpal.installHandler(\"start\", function() {\n    return IPC.send('start').then(function() {\n        return Promise.resolve(\"OK\");\n    });\n}, { description: Tools.translate(\"Opens workers for connections if closed.\") });\n\nvorpal.installHandler(\"rerender [what...]\", function(args) {\n    if (args.options && args.options.list) {\n      return Renderer.getRouterPaths(true).then((paths) => {\n        paths.forEach((path) => {\n          if (typeof path === 'object') {\n            console.log(path.path, path.description);\n          } else {\n            console.log(path);\n          }\n        });\n      });\n    }\n    return IPC.send('stop').then(function() {\n      if (args.what) {\n        return Renderer.rerender(args.what);\n      } else if (args.options && args.options.archive) {\n        return Renderer.rerender();\n      } else {\n        return Renderer.rerender(['**', '!/*/arch/*']);\n      }\n    }).then(function() {\n        return IPC.send('start');\n    }).then(function() {\n        return Promise.resolve(\"OK\");\n    });\n}, {\n    description: Tools.translate(\"Rerenders the cache (workers are closed and then opened again).\"),\n    options: [\n        {\n            value: \"-a, --archive\",\n            description: Tools.translate(\"Rerender archived threads (if no pattern is specified).\")\n        },\n        {\n            value: '-l, --list',\n            description: Tools.translate('Only list available router paths. No rerender.')\n        }\n    ]\n});\n\nvorpal.installHandler(\"reload-boards\", function() {\n    return IPC.send('stop').then(function() {\n        Board.initialize();\n        return IPC.send('reloadBoards');\n    }).then(function() {\n        return IPC.send('start');\n    }).then(function() {\n        return Promise.resolve(\"OK\");\n    });\n}, { description: Tools.translate(\"Reloads the boards.\") });\n\nvorpal.installHandler(\"reload-config [fileName]\", function(args) {\n    args = args.fileName;\n    return IPC.send('stop').then(function() {\n        if (args)\n            config.setConfigFile(args);\n        else\n            config.reload();\n        return IPC.send('reloadConfig', args);\n    }).then(function() {\n        return IPC.send('start');\n    }).then(function() {\n        return Promise.resolve(\"OK\");\n    });\n}, { description: Tools.translate(\"Reloads the config file.\") });\n\nvorpal.installHandler(\"reload-templates\", function(args) {\n    return IPC.send('stop').then(function() {\n        return IPC.send('reloadTemplates');\n    }).then(function() {\n        return IPC.send('start');\n    }).then(function() {\n        return Promise.resolve(\"OK\");\n    });\n}, { description: Tools.translate(\"Reloads the templates and the partials (including public ones).\") });\n\nvorpal.installHandler(\"rebuild-search-index\", function(args) {\n    return this.prompt({\n        type: \"confirm\",\n        name: \"rebuild\",\n        default: true,\n        message: Tools.translate(\"Are you sure? \")\n    }).then(function(result) {\n        if (!result.rebuild)\n            return Promise.resolve();\n        return Database.rebuildSearchIndex().then(function() {\n            return Promise.resolve();\n        });\n    });\n}, { description: Tools.translate(\"Rebuilds post search index.\") });\n\nvorpal.installHandler(\"uptime\", function() {\n    var format = function(seconds) {\n        var pad = function(s) {\n            return (s < 10 ? \"0\" : \"\") + s;\n        };\n        var days = Math.floor(seconds / (24 * 60 * 60));\n        var hours = Math.floor(seconds % (24 * 60 * 60) / (60 * 60));\n        var minutes = Math.floor(seconds % (60 * 60) / 60);\n        var seconds = Math.floor(seconds % 60);\n        return days + \" days \" + pad(hours) + \":\" + pad(minutes) + \":\" + pad(seconds);\n    };\n    return Promise.resolve(format(process.uptime()));\n}, { description: Tools.translate(\"Shows server uptime.\") });\n\nexport default function commands() {\n    console.log(Tools.translate(\"Type 'help' for commands\"));\n    vorpal.delimiter(\"ololord.js>\").show();\n    return vorpal;\n}\n"],"sourceRoot":"/source/"}