{"version":3,"sources":["storage/key.js"],"names":[],"mappings":";;;;;;;;AAAA;;;;AAEA;;IAAY,K;;;;;;;;;;IAES,G;AACnB,eAAY,MAAZ,EAAoB,GAApB,EAAoD;AAAA,qEAAJ,EAAI;;AAAA,QAAzB,KAAyB,QAAzB,KAAyB;AAAA,QAAlB,SAAkB,QAAlB,SAAkB;;AAAA;;AAClD,SAAK,MAAL,GAAc,MAAd;AACA,SAAK,GAAL,GAAW,GAAX;AACA,SAAK,KAAL,GAAa,MAAM,YAAN,CAAmB,KAAnB,CAAb;AACA,SAAK,SAAL,GAAiB,MAAM,iBAAN,CAAwB,SAAxB,CAAjB;AACD;;;;4BAEO,M,EAAQ,S,EAAW;AACzB,aAAO,KAAK,GAAL,IAAY,eAAY,aAAa,GAAzB,IAA+B,MAA/B,GAA0C,EAAtD,CAAP;AACD;;;;2EAES,M;YACJ,I;;;;;;uBAAa,KAAK,MAAL,CAAY,GAAZ,CAAgB,KAAK,OAAL,CAAa,MAAb,CAAhB,C;;;AAAb,oB;iDACG,KAAK,KAAL,CAAW,IAAX,C;;;;;;;;;;;;;;;;;;;4EAGC,I,EAAM,M;;;;;;uBACD,KAAK,MAAL,CAAY,GAAZ,CAAgB,KAAK,OAAL,CAAa,MAAb,CAAhB,EAAsC,KAAK,SAAL,CAAe,IAAf,CAAtC,C;;;;;;;;;;;;;;;;;;;;;;4EAGJ,K,EAAO,M;;;;;AAChB,wBAAS,OAAO,KAAP,KAAiB,WAAlB,SAAqC,KAArC,GAA+C,IAAvD;;uBACa,KAAK,MAAL,CAAY,IAAZ,CAAiB,KAAK,OAAL,CAAa,MAAb,IAAuB,KAAxC,C;;;;;;;;;;;;;;;;;;;;;;4EAGF,M;;;;;;uBACE,KAAK,MAAL,CAAY,GAAZ,CAAgB,KAAK,OAAL,CAAa,MAAb,CAAhB,C;;;;;;;;;;;;;;;;;;;;;;;;kBA3BI,G","file":"storage/key.js","sourcesContent":["import _ from 'underscore';\n\nimport * as Tools from '../helpers/tools';\n\nexport default class Key {\n  constructor(client, key, { parse, stringify } = {}) {\n    this.client = client;\n    this.key = key;\n    this.parse = Tools.selectParser(parse);\n    this.stringify = Tools.selectStringifier(stringify);\n  }\n\n  fullKey(subkey, separator) {\n    return this.key + (subkey ? `${separator || ':'}${subkey}` : '');\n  }\n\n  async get(subkey) {\n    let data = await this.client.get(this.fullKey(subkey));\n    return this.parse(data);\n  }\n\n  async set(data, subkey) {\n    return await this.client.set(this.fullKey(subkey), this.stringify(data));\n  }\n\n  async find(query, subkey) {\n    query = (typeof query !== 'undefined') ? `:${query}` : ':*';\n    return await this.client.keys(this.fullKey(subkey) + query);\n  }\n\n  async delete(subkey) {\n    return await this.client.del(this.fullKey(subkey));\n  }\n}\n"],"sourceRoot":"/source/"}